{"ast":null,"code":"'use strict';\n\nvar exponentialBackoffWithJitter = require('./exponential_backoff_with_jitter');\n\nvar objectToQueryParamString = require('./object_to_query_param_string');\n\nvar packageVersion = require('./package_version');\n\nvar fetch = require('./fetch');\n\nvar AbortController = require('./abort-controller');\n\nvar userAgent = 'Airtable.js/' + packageVersion;\n\nfunction runAction(base, method, path, queryParams, bodyData, callback, numAttempts) {\n  var url = base._airtable._endpointUrl + '/v' + base._airtable._apiVersionMajor + '/' + base._id + path + '?' + objectToQueryParamString(queryParams);\n  var headers = {\n    authorization: 'Bearer ' + base._airtable._apiKey,\n    'x-api-version': base._airtable._apiVersion,\n    'x-airtable-application-id': base.getId(),\n    'content-type': 'application/json'\n  };\n  var isBrowser = typeof window !== 'undefined'; // Some browsers do not allow overriding the user agent.\n  // https://github.com/Airtable/airtable.js/issues/52\n\n  if (isBrowser) {\n    headers['x-airtable-user-agent'] = userAgent;\n  } else {\n    headers['User-Agent'] = userAgent;\n  }\n\n  var controller = new AbortController();\n  var normalizedMethod = method.toUpperCase();\n  var options = {\n    method: normalizedMethod,\n    headers: headers,\n    signal: controller.signal\n  };\n\n  if (bodyData !== null) {\n    if (normalizedMethod === 'GET' || normalizedMethod === 'HEAD') {\n      console.warn('body argument to runAction are ignored with GET or HEAD requests');\n    } else {\n      options.body = JSON.stringify(bodyData);\n    }\n  }\n\n  var timeout = setTimeout(function () {\n    controller.abort();\n  }, base._airtable.requestTimeout);\n  fetch(url, options).then(function (resp) {\n    clearTimeout(timeout);\n\n    if (resp.status === 429 && !base._airtable._noRetryIfRateLimited) {\n      var backoffDelayMs = exponentialBackoffWithJitter(numAttempts);\n      setTimeout(function () {\n        runAction(base, method, path, queryParams, bodyData, callback, numAttempts + 1);\n      }, backoffDelayMs);\n    } else {\n      resp.json().then(function (body) {\n        var error = base._checkStatusForError(resp.status, body); // Ensure Response interface matches interface from\n        // `request` Response object\n\n\n        var r = {};\n        Object.keys(resp).forEach(function (property) {\n          r[property] = resp[property];\n        });\n        r.body = body;\n        r.statusCode = resp.status;\n        callback(error, r, body);\n      }).catch(function () {\n        callback(base._checkStatusForError(resp.status));\n      });\n    }\n  }).catch(function (error) {\n    clearTimeout(timeout);\n    callback(error);\n  });\n}\n\nmodule.exports = runAction;","map":{"version":3,"sources":["/Users/gauravsingh/Desktop/projects/Lucky-India/node_modules/airtable/lib/run_action.js"],"names":["exponentialBackoffWithJitter","require","objectToQueryParamString","packageVersion","fetch","AbortController","userAgent","runAction","base","method","path","queryParams","bodyData","callback","numAttempts","url","_airtable","_endpointUrl","_apiVersionMajor","_id","headers","authorization","_apiKey","_apiVersion","getId","isBrowser","window","controller","normalizedMethod","toUpperCase","options","signal","console","warn","body","JSON","stringify","timeout","setTimeout","abort","requestTimeout","then","resp","clearTimeout","status","_noRetryIfRateLimited","backoffDelayMs","json","error","_checkStatusForError","r","Object","keys","forEach","property","statusCode","catch","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nvar exponentialBackoffWithJitter = require('./exponential_backoff_with_jitter');\nvar objectToQueryParamString = require('./object_to_query_param_string');\nvar packageVersion = require('./package_version');\nvar fetch = require('./fetch');\nvar AbortController = require('./abort-controller');\n\nvar userAgent = 'Airtable.js/' + packageVersion;\n\nfunction runAction(base, method, path, queryParams, bodyData, callback, numAttempts) {\n    var url =\n        base._airtable._endpointUrl +\n        '/v' +\n        base._airtable._apiVersionMajor +\n        '/' +\n        base._id +\n        path +\n        '?' +\n        objectToQueryParamString(queryParams);\n\n    var headers = {\n        authorization: 'Bearer ' + base._airtable._apiKey,\n        'x-api-version': base._airtable._apiVersion,\n        'x-airtable-application-id': base.getId(),\n        'content-type': 'application/json',\n    };\n    var isBrowser = typeof window !== 'undefined';\n    // Some browsers do not allow overriding the user agent.\n    // https://github.com/Airtable/airtable.js/issues/52\n    if (isBrowser) {\n        headers['x-airtable-user-agent'] = userAgent;\n    } else {\n        headers['User-Agent'] = userAgent;\n    }\n\n    var controller = new AbortController();\n    var normalizedMethod = method.toUpperCase();\n    var options = {\n        method: normalizedMethod,\n        headers: headers,\n        signal: controller.signal,\n    };\n\n    if (bodyData !== null) {\n        if (normalizedMethod === 'GET' || normalizedMethod === 'HEAD') {\n            console.warn('body argument to runAction are ignored with GET or HEAD requests');\n        } else {\n            options.body = JSON.stringify(bodyData);\n        }\n    }\n\n    var timeout = setTimeout(function() {\n        controller.abort();\n    }, base._airtable.requestTimeout);\n\n    fetch(url, options)\n        .then(function(resp) {\n            clearTimeout(timeout);\n            if (resp.status === 429 && !base._airtable._noRetryIfRateLimited) {\n                var backoffDelayMs = exponentialBackoffWithJitter(numAttempts);\n                setTimeout(function() {\n                    runAction(base, method, path, queryParams, bodyData, callback, numAttempts + 1);\n                }, backoffDelayMs);\n            } else {\n                resp.json()\n                    .then(function(body) {\n                        var error = base._checkStatusForError(resp.status, body);\n                        // Ensure Response interface matches interface from\n                        // `request` Response object\n                        var r = {};\n                        Object.keys(resp).forEach(function(property) {\n                            r[property] = resp[property];\n                        });\n                        r.body = body;\n                        r.statusCode = resp.status;\n                        callback(error, r, body);\n                    })\n                    .catch(function() {\n                        callback(base._checkStatusForError(resp.status));\n                    });\n            }\n        })\n        .catch(function(error) {\n            clearTimeout(timeout);\n            callback(error);\n        });\n}\n\nmodule.exports = runAction;\n"]},"metadata":{},"sourceType":"script"}